<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stationery Dashboard</title>
    <!-- å¼•å…¥å¤šç§æ‰‹å†™å­—ä½“ï¼ŒåŒ¹é…ä¸åŒçº¸å¼ é£æ ¼ -->
    <link href="https://fonts.googleapis.com/css2?family=Gaegu:wght@400;700&family=Long+Cang&family=Patrick+Hand&family=Zeyada&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-desk: #f4f4f6; /* æ¡Œé¢èƒŒæ™¯ */
            --drawer-color: #6d6875;
            --text-dark: #4a4a4a;
        }

        * { box-sizing: border-box; }

        body {
            margin: 0;
            padding: 20px;
            background-color: var(--bg-desk);
            font-family: 'Patrick Hand', sans-serif;
            color: var(--text-dark);
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* --- æ ¸å¿ƒç½‘æ ¼å¸ƒå±€ --- */
        .grid-container {
            display: grid;
            /* å“åº”å¼ç½‘æ ¼ï¼šæ¯åˆ—æœ€å°140pxï¼Œè‡ªåŠ¨å¡«æ»¡ */
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
            padding-bottom: 60px; /* ç•™ç»™åº•éƒ¨å½’æ¡£æ¡çš„ç©ºé—´ */
            overflow-y: auto;
            flex-grow: 1;
            /* éšè—æ»šåŠ¨æ¡ä½†å…è®¸æ»šåŠ¨ */
            scrollbar-width: none; 
        }
        .grid-container::-webkit-scrollbar { display: none; }

        /* --- é€šç”¨ä¾¿ç­¾å¡ç‰‡æ ·å¼ --- */
        .pad-item {
            aspect-ratio: 3/4; /* ä¿æŒ 3:4 çš„é•¿å®½æ¯”ï¼Œåƒå°å¡ç‰‡ */
            padding: 15px;
            border-radius: 4px;
            box-shadow: 2px 4px 8px rgba(0,0,0,0.08);
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .pad-item:hover {
            transform: translateY(-4px);
            box-shadow: 4px 8px 12px rgba(0,0,0,0.12);
            z-index: 2;
        }

        .pad-content {
            font-size: 1rem;
            line-height: 1.4;
            flex-grow: 1;
            overflow: hidden;
            word-wrap: break-word;
            white-space: pre-wrap;
        }

        .pad-empty-hint {
            color: rgba(0,0,0,0.3);
            text-align: center;
            margin-top: 50%;
            transform: translateY(-50%);
            font-size: 1.2rem;
            pointer-events: none;
        }

        .pad-date {
            font-size: 0.7rem;
            opacity: 0.6;
            text-align: right;
            margin-top: 5px;
            font-family: sans-serif;
        }

        /* --- ğŸ¨ 8ç§ä¸åŒçš„çº¸å¼ é£æ ¼ (CSS æ¨¡æ‹Ÿ) --- */

        /* 1. ç²‰è‰²å…‰æ™• (å·¦ä¸Š) */
        .style-pink-aura {
            background: radial-gradient(circle at center, #ffe6f2 0%, #fff0f5 40%, #ffffff 100%);
            border: 1px solid #ffe6f2;
            font-family: 'Zeyada', cursive;
            font-size: 1.2rem;
        }

        /* 2. è–„è·ç»¿æ¡çº¹ (ä¸­ä¸Š) */
        .style-mint-stripe {
            background-color: #e8f5e9;
            background-image: repeating-linear-gradient(90deg, transparent, transparent 19px, #c8e6c9 20px);
            font-family: 'Gaegu', cursive;
        }

        /* 3. è“è‰²äº‘æœµ (å³ä¸Š) */
        .style-blue-cloud {
            background: radial-gradient(circle at 20% 20%, #e3f2fd, transparent 40%),
                        radial-gradient(circle at 80% 80%, #bbdefb, transparent 40%),
                        #f0f8ff;
            font-family: 'Patrick Hand', cursive;
        }

        /* 4. To Do List (å·¦ä¸­ - æ£•è‰²å¤´) */
        .style-todo {
            background: #e8f6e9; /* æµ…ç»¿åº• */
            background-image: radial-gradient(#a5d6a7 15%, transparent 16%);
            background-size: 20px 20px;
        }
        .style-todo::before {
            content: "TO THE LIST";
            display: block;
            background: #d7ccc8;
            color: white;
            text-align: center;
            padding: 4px;
            margin: -15px -15px 10px -15px;
            font-size: 0.8rem;
            letter-spacing: 1px;
        }

        /* 5. è±å½¢æ ¼çº¹ (ä¸­ä¸­) */
        .style-plaid {
            background-color: #fff;
            background-image: linear-gradient(45deg, #f8bbd0 25%, transparent 25%, transparent 75%, #f8bbd0 75%, #f8bbd0),
                              linear-gradient(45deg, #f8bbd0 25%, transparent 25%, transparent 75%, #f8bbd0 75%, #f8bbd0);
            background-size: 40px 40px;
            background-position: 0 0, 20px 20px;
            opacity: 0.9;
        }
        /* å¢åŠ ç™½è‰²é®ç½©è®©å­—æ›´æ¸…æ™° */
        .style-plaid .pad-content {
            background: rgba(255,255,255,0.85);
            padding: 5px;
            border-radius: 4px;
        }

        /* 6. ä¹è°±çº¿ (å³ä¸­) */
        .style-music {
            background-color: #fff;
            background-image: repeating-linear-gradient(transparent, transparent 19px, #e0e0e0 20px);
            font-family: 'Long Cang', cursive;
            font-size: 1.2rem;
        }

        /* 7. è‹±æ–‡æœ¬ (å·¦ä¸‹ - ç²‰çº¿) */
        .style-english {
            background-color: #fff;
            background-image: linear-gradient(#ffcdd2 1px, transparent 1px);
            background-size: 100% 25px;
            line-height: 25px !important; /* å¼ºåˆ¶è¡Œé«˜å¯¹é½ */
        }

        /* 8. ç»¿è‰²æ–¹æ ¼ (ä¸­ä¸‹) */
        .style-grid-green {
            background-color: #f1f8e9;
            background-image: 
                linear-gradient(#c5e1a5 1px, transparent 1px),
                linear-gradient(90deg, #c5e1a5 1px, transparent 1px);
            background-size: 15px 15px;
        }

        /* --- åº•éƒ¨æ”¶çº³æŠ½å±‰ --- */
        .drawer-bar {
            position: fixed;
            bottom: 0; left: 0; right: 0;
            height: 50px;
            background: var(--drawer-color);
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            border-top-left-radius: 15px;
            border-top-right-radius: 15px;
            font-family: 'Gaegu', cursive;
            font-size: 1.4rem;
            transition: height 0.3s;
            z-index: 10;
        }
        .drawer-bar:hover { height: 60px; }

        /* --- ç¼–è¾‘æ¨¡æ€æ¡† --- */
        .modal {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(255,255,255,0.9);
            z-index: 100;
            display: none;
            justify-content: center;
            align-items: center;
        }
        .modal.active { display: flex; animation: fadeIn 0.2s; }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        .editor-card {
            width: 90%;
            max-width: 500px;
            height: 70vh;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            display: flex;
            flex-direction: column;
            border: 2px solid #eee;
        }

        textarea {
            flex-grow: 1;
            border: none;
            resize: none;
            font-family: inherit;
            font-size: 1.2rem;
            margin-bottom: 15px;
            color: #333;
        }

        .editor-actions {
            display: flex;
            justify-content: space-between;
        }

        .btn {
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            font-family: 'Gaegu', cursive;
            font-size: 1.1rem;
            font-weight: bold;
        }
        .btn-save { background: #B5EAD7; color: #444; }
        .btn-archive { background: #ffb7b2; color: white; }
        .btn-cancel { background: transparent; color: #999; }

        /* --- å½’æ¡£åˆ—è¡¨æ¨¡æ€æ¡† --- */
        .archive-list-modal {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: #fff;
            z-index: 110;
            display: none;
            flex-direction: column;
            padding: 20px;
        }
        .archive-list-modal.active { display: flex; }
        
        .archive-item {
            padding: 15px;
            border-bottom: 1px dashed #ccc;
            background: #fafafa;
            margin-bottom: 10px;
            border-radius: 8px;
        }

    </style>
</head>
<body>

<!-- æ ¸å¿ƒç½‘æ ¼ï¼šå›ºå®š 8 ä¸ªä¾¿ç­¾ä½ -->
<div class="grid-container">
    <div class="pad-item style-pink-aura" onclick="openEditor(0)"></div>
    <div class="pad-item style-mint-stripe" onclick="openEditor(1)"></div>
    <div class="pad-item style-blue-cloud" onclick="openEditor(2)"></div>
    <div class="pad-item style-todo" onclick="openEditor(3)"></div>
    <div class="pad-item style-plaid" onclick="openEditor(4)"></div>
    <div class="pad-item style-music" onclick="openEditor(5)"></div>
    <div class="pad-item style-english" onclick="openEditor(6)"></div>
    <div class="pad-item style-grid-green" onclick="openEditor(7)"></div>
</div>

<!-- åº•éƒ¨æ”¶çº³ -->
<div class="drawer-bar" onclick="toggleArchiveList()">
    ğŸ“‚ Archive Drawer
</div>

<!-- ç¼–è¾‘å™¨å¼¹çª— -->
<div class="modal" id="editor-modal">
    <div class="editor-card" id="editor-card">
        <textarea id="note-input" placeholder="Write something here..."></textarea>
        <div class="editor-actions">
            <div>
                <button class="btn btn-archive" onclick="archiveCurrent()">Archive & Clear</button>
            </div>
            <div>
                <button class="btn btn-cancel" onclick="closeEditor()">Close</button>
                <button class="btn btn-save" onclick="saveCurrent()">Save</button>
            </div>
        </div>
    </div>
</div>

<!-- å½’æ¡£åˆ—è¡¨å¼¹çª— -->
<div class="archive-list-modal" id="archive-modal">
    <div style="display:flex; justify-content:space-between; margin-bottom:20px;">
        <h2 style="margin:0;">ğŸ—ƒï¸ Past Notes</h2>
        <button class="btn btn-cancel" onclick="toggleArchiveList()" style="font-size:1.5rem;">Ã—</button>
    </div>
    <div id="archive-container" style="overflow-y:auto; flex-grow:1;">
        <!-- JS ç”Ÿæˆ -->
    </div>
</div>

<script>
    // --- 1. é…ç½®ä¸çŠ¶æ€ ---
    const PAD_COUNT = 8;
    // å›ºå®šçš„ 8 ä¸ªä¾¿ç­¾ä½çš„æ•°æ®ï¼Œåªå­˜å†…å®¹å’Œæ—¥æœŸ
    let activePads = JSON.parse(localStorage.getItem('stationery_pads_v3')) || new Array(PAD_COUNT).fill(null);
    // å½’æ¡£æ•°æ®
    let archives = JSON.parse(localStorage.getItem('stationery_archives_v3')) || [];

    let currentEditingIndex = -1;

    // --- 2. æ¸²æŸ“ä¸»ç½‘æ ¼ ---
    function renderGrid() {
        const pads = document.querySelectorAll('.pad-item');
        pads.forEach((pad, index) => {
            const data = activePads[index];
            // æ¸…ç©ºæ—§å†…å®¹
            pad.innerHTML = '';
            
            if (!data || !data.content) {
                // ç©ºçŠ¶æ€
                pad.innerHTML = `<div class="pad-empty-hint">Write Here</div>`;
            } else {
                // æœ‰å†…å®¹çŠ¶æ€
                pad.innerHTML = `
                    <div class="pad-content">${data.content}</div>
                    <div class="pad-date">${formatDate(data.updatedAt)}</div>
                `;
            }
        });
    }

    // --- 3. äº¤äº’é€»è¾‘ ---

    function openEditor(index) {
        currentEditingIndex = index;
        const modal = document.getElementById('editor-modal');
        const textarea = document.getElementById('note-input');
        
        // è½½å…¥å·²æœ‰å†…å®¹
        const data = activePads[index];
        textarea.value = data ? data.content : '';
        
        // è®¾ç½®ç¼–è¾‘å™¨èƒŒæ™¯è‰²ä»¥åŒ¹é…é€‰ä¸­çš„çº¸å¼ ï¼ˆå¢åŠ æ²‰æµ¸æ„Ÿï¼‰
        // è·å– CSS è®¡ç®—åçš„èƒŒæ™¯
        const padStyle = window.getComputedStyle(document.querySelectorAll('.pad-item')[index]);
        const editorCard = document.getElementById('editor-card');
        // è¿™é‡Œç®€å•åœ°è®¾ä¸ºç™½è‰²èƒŒæ™¯ï¼Œä½†ä¿ç•™æ–‡å­—å­—ä½“
        textarea.style.fontFamily = padStyle.fontFamily;
        
        modal.classList.add('active');
        textarea.focus();
    }

    function closeEditor() {
        document.getElementById('editor-modal').classList.remove('active');
        currentEditingIndex = -1;
    }

    function saveCurrent() {
        if (currentEditingIndex === -1) return;
        
        const content = document.getElementById('note-input').value.trim();
        
        if (content) {
            activePads[currentEditingIndex] = {
                content: content,
                updatedAt: Date.now()
            };
        } else {
            // å¦‚æœæ¸…ç©ºäº†å†…å®¹ï¼Œè§†ä¸ºé‡ç½®
            activePads[currentEditingIndex] = null;
        }
        
        saveData();
        renderGrid();
        closeEditor();
    }

    function archiveCurrent() {
        if (currentEditingIndex === -1) return;
        const data = activePads[currentEditingIndex];
        
        if (data && data.content) {
            // æ·»åŠ åˆ°å½’æ¡£
            archives.unshift({
                content: data.content,
                archivedAt: Date.now(),
                styleIndex: currentEditingIndex // è®°å½•åŸæ¥æ˜¯å“ªç§çº¸ï¼Œä»¥åå¯ä»¥åšé¢œè‰²æ ‡è®°
            });
            // æ¸…ç©ºå½“å‰çº¸å¼ 
            activePads[currentEditingIndex] = null;
            
            saveData();
            renderGrid();
            closeEditor();
            alert("Moved to Archive Drawer!");
        } else {
            closeEditor();
        }
    }

    // --- 4. å½’æ¡£æŠ½å±‰é€»è¾‘ ---
    function toggleArchiveList() {
        const modal = document.getElementById('archive-modal');
        const isActive = modal.classList.contains('active');
        
        if (!isActive) {
            renderArchives();
            modal.classList.add('active');
        } else {
            modal.classList.remove('active');
        }
    }

    function renderArchives() {
        const container = document.getElementById('archive-container');
        container.innerHTML = '';
        
        if (archives.length === 0) {
            container.innerHTML = '<div style="text-align:center; color:#999; margin-top:20px;">Drawer is empty.</div>';
            return;
        }

        archives.forEach(item => {
            const div = document.createElement('div');
            div.className = 'archive-item';
            div.innerHTML = `
                <div style="font-size:1.1rem; margin-bottom:5px;">${item.content}</div>
                <div style="font-size:0.8rem; color:#888; text-align:right;">
                    Archived on ${formatDate(item.archivedAt)}
                </div>
            `;
            container.appendChild(div);
        });
    }

    // --- 5. å·¥å…·å‡½æ•° ---
    function saveData() {
        localStorage.setItem('stationery_pads_v3', JSON.stringify(activePads));
        localStorage.setItem('stationery_archives_v3', JSON.stringify(archives));
    }

    function formatDate(ts) {
        if (!ts) return '';
        const d = new Date(ts);
        return `${d.getMonth()+1}/${d.getDate()} ${d.getHours()}:${String(d.getMinutes()).padStart(2,'0')}`;
    }

    // åˆå§‹åŒ–
    renderGrid();

</script>

</body>
</html>
